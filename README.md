# Pen Testing
_Rob Hunter - 2019_

> _Seeker - Builder - Distiller - Breaker - Curator_

This is a repo of my methodologies, workflows, tools, techniques and scripts that could be useful during a Pen Test.

README is a mix of notes from study material, books, courses, etc - see below for incomplete list of reference material.

## Pen Testing Overview
1. Project Kick-off
2. Information Gathering: Passive and Active Recon
3. Vulnerability Identification
4. Exploitation/Vulnerability Validation
5. Post-exploitation
6. Reporting
7. Cleanup

## Pen Testing Specializations
* Project Management:  Kick-off, On-going Activities, Reporting, Closeout/Outbrief.
* OSINT
* Phishing
* Social Engineering and Physical
* External Network
* Internal Infrastructure: Network Devices, Firewall, Wireless, Active Directory, Containers, Kubernetes, etc.
* Web Application: Dynamic, Static Source Code, API, Web Services, etc
* Cloud Based (AWS, Azure): Identity and Access Management, Security, Storage, Logging, Monitoring, etc.

## Scripts

## Passive Recon Workflow
1. 


## Active Recon Workflow (Map the network, identify live hosts, enumerate open ports and running services)
1. nbtscan -r <IPaddres/CIDR>, netdiscover -i < >
2. Staged nmap Scans: Host Discover (-sn), Full Port Discovery (-sS & -sU, -p-, --open), OS Detection (-O), Service Enumeration (-sV)
3. Specalized Enumeration (NSE - /usr/share/nmap/scripts/) & Tools: 
+ 	web/http: nmap (-sS -p 80,443), Nikto, dirb, Dirbuster (/usr/share/dirbuster/wordlists/), nc banner grab (nc <IPaddress> <port>), msf
+ 	SMB/NetBIOS: nmap (-sU -sS -p U:137-139,T:137-139,445), nmap nse (/smb*), nbtscan, enum4linux, SMBv1 - Null Session: rpcclient -U "" <IPaddress> ...>querydominfo
+ 	SMTP: nmap (-sS -p 25), nc banner grab (nc -nv <IPaddress> 25), 
+ 	SNMP: nmap (-sU -p 161), nmap nse (/snmp*), onesixtyone, snmpwalk
+ 	DB (Oracle: 1521, SQL Server: 1433/1434, MySQL: 3306):  nmap (-sU -p 1433,1434,1521,3306), nmap nse (--script
+ 	FTP: 
4. ...


## Tools

## Refining Workflow Through Scripted Automation

#### DNS
...

#### SMTP Automation of netcat Banner Grab
1. Create Target IP Address list:  nmap -p 25 --open -oA smtp_targets -iL LiveHosts.txt -oG smtp; grep for Up; cut on space for the 2nd field; write to smtp_targets.txt
2. Bash One-liner:  for ip in $(cat smtp_targets.txt); do echo VRFY bob | nc -nv -w 30 $ip 25;done > smtp_enum.txt

#### SNMP Automation of snmpwalk MIB Enumeration
1. Determinte Target IP Addresses & Version with nmap & onesixtyone:  
+ 	nmap (-sUV -p 161 --open); 
+ 	create community.txt (public private manager)
+ 	then then cut and 
2. Create MIB
3. Bash One-liner:  for mib in $(cat mib_values); do snmpwalk -c public -v1 <IPaddress> $mib; done > 161walk.txt

#### Targeted NSE scan for port 80 (versus --script all) for all http-vulns on all hosts with port 80 open using targeted list, and export file with unique name
1. mkdir http_80 
2. Create web_targets:  
		1. nmap -p 80 -v -A --open -iL ping_seep -oG web
		2. cat web | grep Up
		3. cat web | grep Up | cut -d " " -f 2
		4. cat web | grep Up | cut -d " " -f 2 > http_targets.txt
3. Create nse_http_vulns.txt:  
		1. ls /usr/share/nmap/scripts/ | grep http-vuln > nse_http_vulns.txt
4. Bash One-liner:  for vulns in $(cat nse_http_vulns.txt); do nmap -v -p 80 --script $vulns -iL http_targets.txt -oN $vulns; done
5. Easy to visually scan list to open targeted files:  _cat *.nmap | grep http-vuln --color_


## Resources ( incomplete ):
* http://nmap.org/presentations/BHDC08/bhdc08-slides-fyodor.pdf
* https://github.com/sdcampbell/Internal-Pentest-Playbook
* Weidman, G. (2014). Penetration Testing. San Francisco, California. No Starch Press Inc.
* http://www.googleguide.com/advanced_operators_reference.html
* Bowne, S. (2019). .... samsclass.info
* https://jasonhaddix.com/
* https://www.virtualhackinglabs.com/ (Courseware)
* ...
